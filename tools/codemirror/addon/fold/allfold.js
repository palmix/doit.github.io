!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,n){function r(r){for(var l=n.ch,u=0;;){var a=0>=l?-1:f.lastIndexOf(r,l-1);if(-1!=a){if(1==u&&a<n.ch)break;if(o=t.getTokenTypeAt(e.Pos(i,a+1)),!/^(comment|string)/.test(o))return a+1;l=a-1}else{if(1==u)break;u=1,l=f.length}}}var o,i=n.line,f=t.getLine(i),l="{",u="}",a=r("{");if(null==a&&(l="[",u="]",a=r("[")),null!=a){var c,d,s=1,m=t.lastLine();e:for(var g=i;m>=g;++g)for(var p=t.getLine(g),v=g==i?a:0;;){var h=p.indexOf(l,v),b=p.indexOf(u,v);if(0>h&&(h=p.length),0>b&&(b=p.length),v=Math.min(h,b),v==p.length)break;if(t.getTokenTypeAt(e.Pos(g,v+1))==o)if(v==h)++s;else if(!--s){c=g,d=v;break e}++v}if(null!=c&&i!=c)return{from:e.Pos(i,a),to:e.Pos(c,d)}}}),e.registerHelper("fold","import",function(t,n){function r(n){if(n<t.firstLine()||n>t.lastLine())return null;var r=t.getTokenAt(e.Pos(n,1));if(/\S/.test(r.string)||(r=t.getTokenAt(e.Pos(n,r.end+1))),"keyword"!=r.type||"import"!=r.string)return null;for(var o=n,i=Math.min(t.lastLine(),n+10);i>=o;++o){var f=t.getLine(o),l=f.indexOf(";");if(-1!=l)return{startCh:r.end,end:e.Pos(o,l)}}}var o,i=n.line,f=r(i);if(!f||r(i-1)||(o=r(i-2))&&o.end.line==i-1)return null;for(var l=f.end;;){var u=r(l.line+1);if(null==u)break;l=u.end}return{from:t.clipPos(e.Pos(i,f.startCh+1)),to:l}}),e.registerHelper("fold","include",function(t,n){function r(n){if(n<t.firstLine()||n>t.lastLine())return null;var r=t.getTokenAt(e.Pos(n,1));return/\S/.test(r.string)||(r=t.getTokenAt(e.Pos(n,r.end+1))),"meta"==r.type&&"#include"==r.string.slice(0,8)?r.start+8:void 0}var o=n.line,i=r(o);if(null==i||null!=r(o-1))return null;for(var f=o;;){var l=r(f+1);if(null==l)break;++f}return{from:e.Pos(o,i+1),to:t.clipPos(e.Pos(f))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var r=t.getModeAt(n),o=r.blockCommentStart,i=r.blockCommentEnd;if(o&&i){for(var f,l=n.line,u=t.getLine(l),a=n.ch,c=0;;){var d=0>=a?-1:u.lastIndexOf(o,a-1);if(-1!=d){if(1==c&&d<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(l,d+1)))&&(0==d||u.slice(d-i.length,d)==i||!/comment/.test(t.getTokenTypeAt(e.Pos(l,d))))){f=d+o.length;break}a=d-1}else{if(1==c)return;c=1,a=u.length}}var s,m,g=1,p=t.lastLine();e:for(var v=l;p>=v;++v)for(var h=t.getLine(v),b=v==l?f:0;;){var x=h.indexOf(o,b),C=h.indexOf(i,b);if(0>x&&(x=h.length),0>C&&(C=h.length),b=Math.min(x,C),b==h.length)break;if(b==x)++g;else if(!--g){s=v,m=b;break e}++b}if(null!=s&&(l!=s||m!=f))return{from:e.Pos(l,f),to:e.Pos(s,m)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,o,i,f){function l(e){var n=u(t,o);if(!n||n.to.line-n.from.line<a)return null;for(var r=t.findMarksAt(n.from),i=0;i<r.length;++i)if(r[i].__isFold&&"fold"!==f){if(!e)return null;n.cleared=!0,r[i].clear()}return n}if(i&&i.call){var u=i;i=null}else var u=r(t,i,"rangeFinder");"number"==typeof o&&(o=e.Pos(o,0));var a=r(t,i,"minFoldSize"),c=l(!0);if(r(t,i,"scanUp"))for(;!c&&o.line>t.firstLine();)o=e.Pos(o.line-1,0),c=l(!1);if(c&&!c.cleared&&"unfold"!==f){var d=n(t,i,c);e.on(d,"mousedown",function(t){s.clear(),e.e_preventDefault(t)});var s=t.markText(c.from,c.to,{replacedWith:d,clearOnEnter:r(t,i,"clearOnEnter"),__isFold:!0});s.on("clear",function(n,r){e.signal(t,"unfold",t,n,r)}),e.signal(t,"fold",t,c.from,c.to)}}function n(e,t,n){var o=r(e,t,"widget");if("function"==typeof o&&(o=o(n.from,n.to)),"string"==typeof o){var i=document.createTextNode(o);o=document.createElement("span"),o.appendChild(i),o.className="CodeMirror-foldmarker"}else o&&(o=o.cloneNode(!0));return o}function r(e,t,n){if(t&&void 0!==t[n])return t[n];var r=e.options.foldOptions;return r&&void 0!==r[n]?r[n]:o[n]}e.newFoldFunction=function(e,n){return function(r,o){t(r,o,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",function(e,n,r){t(this,e,n,r)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var n=t.firstLine(),r=t.lastLine();r>=n;n++)t.foldCode(e.Pos(n,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var n=t.firstLine(),r=t.lastLine();r>=n;n++)t.foldCode(e.Pos(n,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var r=0;r<e.length;++r){var o=e[r](t,n);if(o)return o}}}),e.registerHelper("fold","auto",function(e,t){for(var n=e.getHelpers(t,"fold"),r=0;r<n.length;r++){var o=n[r](e,t);if(o)return o}});var o={rangeFinder:e.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return r(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function n(e){return e===!0&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function r(e,t){for(var n=e.findMarks(s(t,0),s(t+1,0)),r=0;r<n.length;++r)if(n[r].__isFold){var o=n[r].find(-1);if(o&&o.line===t)return n[r]}}function o(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function i(e,t,n){var i=e.state.foldGutter.options,l=t-1,u=e.foldOption(i,"minFoldSize"),a=e.foldOption(i,"rangeFinder"),c="string"==typeof i.indicatorFolded&&f(i.indicatorFolded),d="string"==typeof i.indicatorOpen&&f(i.indicatorOpen);e.eachLine(t,n,function(t){++l;var n=null,f=t.gutterMarkers;if(f&&(f=f[i.gutter]),r(e,l)){if(c&&f&&c.test(f.className))return;n=o(i.indicatorFolded)}else{var m=s(l,0),g=a&&a(e,m);if(g&&g.to.line-g.from.line>=u){if(d&&f&&d.test(f.className))return;n=o(i.indicatorOpen)}}(n||f)&&e.setGutterMarker(t,i.gutter,n)})}function f(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function l(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){i(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function u(e,t,n){var o=e.state.foldGutter;if(o){var i=o.options;if(n==i.gutter){var f=r(e,t);f?f.clear():e.foldCode(s(t,0),i)}}}function a(e){var t=e.state.foldGutter;if(t){var n=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){l(e)},n.foldOnChangeTimeSpan||600)}}function c(e){var t=e.state.foldGutter;if(t){var n=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var n=e.getViewport();t.from==t.to||n.from-t.to>20||t.from-n.to>20?l(e):e.operation(function(){n.from<t.from&&(i(e,n.from,t.from),t.from=n.from),n.to>t.to&&(i(e,t.to,n.to),t.to=n.to)})},n.updateViewportTimeSpan||400)}}function d(e,t){var n=e.state.foldGutter;if(n){var r=t.line;r>=n.from&&r<n.to&&i(e,r,r+1)}}e.defineOption("foldGutter",!1,function(r,o,i){i&&i!=e.Init&&(r.clearGutter(r.state.foldGutter.options.gutter),r.state.foldGutter=null,r.off("gutterClick",u),r.off("changes",a),r.off("viewportChange",c),r.off("fold",d),r.off("unfold",d),r.off("swapDoc",a)),o&&(r.state.foldGutter=new t(n(o)),l(r),r.on("gutterClick",u),r.on("changes",a),r.on("viewportChange",c),r.on("fold",d),r.on("unfold",d),r.on("swapDoc",a))});var s=e.Pos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n){var r=t.getLine(n),o=r.search(/\S/);return-1==o||/\bcomment\b/.test(t.getTokenTypeAt(e.Pos(n,o+1)))?-1:e.countColumn(r,null,t.getOption("tabSize"))}e.registerHelper("fold","indent",function(n,r){var o=t(n,r.line);if(!(0>o)){for(var i=null,f=r.line+1,l=n.lastLine();l>=f;++f){var u=t(n,f);if(-1==u);else{if(!(u>o))break;i=f}}return i?{from:e.Pos(r.line,n.getLine(r.line).length),to:e.Pos(i,n.getLine(i).length)}:void 0}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,n){function r(n){var r=t.getTokenTypeAt(e.Pos(n,0));return r&&/\bheader\b/.test(r)}function o(e,t,n){var o=t&&t.match(/^#+/);return o&&r(e)?o[0].length:(o=n&&n.match(/^[=\-]+\s*$/),o&&r(e+1)?"="==n[0]?1:2:i)}var i=100,f=t.getLine(n.line),l=t.getLine(n.line+1),u=o(n.line,f,l);if(u!==i){for(var a=t.lastLine(),c=n.line,d=t.getLine(c+2);a>c&&!(o(c+1,l,d)<=u);)++c,l=d,d=t.getLine(c+2);return{from:e.Pos(n.line,f.length),to:e.Pos(c,t.getLine(c).length)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,r){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=r?Math.max(r.from,e.firstLine()):e.firstLine(),this.max=r?Math.min(r.to-1,e.lastLine()):e.lastLine()}function r(e,t){var n=e.cm.getTokenTypeAt(s(e.line,t));return n&&/\btag\b/.test(n)}function o(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function i(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function f(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(o(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t+1}}}function l(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(i(e))continue;return}if(r(e,t+1)){p.lastIndex=t,e.ch=t;var n=p.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function u(e){for(;;){p.lastIndex=e.ch;var t=p.exec(e.text);if(!t){if(o(e))continue;return}{if(r(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function a(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(i(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),o=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t}}}function c(e,t){for(var n=[];;){var r,o=u(e),i=e.line,l=e.ch-(o?o[0].length:0);if(!o||!(r=f(e)))return;if("selfClose"!=r)if(o[1]){for(var a=n.length-1;a>=0;--a)if(n[a]==o[2]){n.length=a;break}if(0>a&&(!t||t==o[2]))return{tag:o[2],from:s(i,l),to:s(e.line,e.ch)}}else n.push(o[2])}}function d(e,t){for(var n=[];;){var r=a(e);if(!r)return;if("selfClose"!=r){var o=e.line,i=e.ch,f=l(e);if(!f)return;if(f[1])n.push(f[2]);else{for(var u=n.length-1;u>=0;--u)if(n[u]==f[2]){n.length=u;break}if(0>u&&(!t||t==f[2]))return{tag:f[2],from:s(e.line,e.ch),to:s(o,i)}}}else l(e)}}var s=e.Pos,m="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",g=m+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",p=new RegExp("<(/?)(["+m+"]["+g+"]*)","g");e.registerHelper("fold","xml",function(e,r){for(var o=new n(e,r.line,0);;){var i=u(o);if(!i||o.line!=r.line)return;var l=f(o);if(!l)return;if(!i[1]&&"selfClose"!=l){var a=s(o.line,o.ch),d=c(o,i[2]);return d&&t(d.from,a)>0?{from:a,to:d.from}:null}}}),e.findMatchingTag=function(e,r,o){var i=new n(e,r.line,r.ch,o);if(-1!=i.text.indexOf(">")||-1!=i.text.indexOf("<")){var u=f(i),a=u&&s(i.line,i.ch),m=u&&l(i);if(u&&m&&!(t(i,r)>0)){var g={from:s(i.line,i.ch),to:a,tag:m[2]};return"selfClose"==u?{open:g,close:null,at:"open"}:m[1]?{open:d(i,m[2]),close:g,at:"close"}:(i=new n(e,a.line,a.ch,o),{open:g,close:c(i,m[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,r,o){for(var i=new n(e,t.line,t.ch,r);;){var f=d(i,o);if(!f)break;var l=new n(e,t.line,t.ch,r),u=c(l,f.tag);if(u)return{open:f,close:u}}},e.scanForClosingTag=function(e,t,r,o){var i=new n(e,t.line,t.ch,o?{from:0,to:o}:null);return c(i,r)}});